"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[7834],{14526:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(67294),i=t(92053);function o(e){return a.createElement(i.Z,e)}},66710:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>g,frontMatter:()=>s,metadata:()=>p,toc:()=>u});var a=t(87462),i=(t(67294),t(3905));const o='#\n# Your Crowdin credentials\n#\nproject_id: \'428890\'\napi_token_env: CROWDIN_PERSONAL_TOKEN\n# base_path: \'.\'\n# base_url: https://api.crowdin.com\n\n#\n# Choose file structure in Crowdin\n# e.g. true or false\n#\npreserve_hierarchy: true\n\n# We generally want to use the "two-letters-code" of a locale (ie the language)\n# But not for all locales!\n# "pt-BR" may be better to remain as "pt-BR" instead of being transformed to "pt"\n# Note: &/* is Yaml anchor syntax: https://support.atlassian.com/bitbucket-cloud/docs/yaml-anchors/\nlanguages_mapping: &languages_mapping\n  two_letters_code:\n    pt-BR: pt-BR\n\n#\n# Files configuration\n#\nfiles:\n  - source: /website/i18n/en/**/*\n    translation: /website/i18n/%two_letters_code%/**/%original_file_name%\n    languages_mapping: *languages_mapping\n  - source: /website/docs/**/*\n    translation: /website/i18n/%two_letters_code%/docusaurus-plugin-content-docs/current/**/%original_file_name%\n    languages_mapping: *languages_mapping\n  - source: /website/community/**/*\n    translation: /website/i18n/%two_letters_code%/docusaurus-plugin-content-docs-community/current/**/%original_file_name%\n    languages_mapping: *languages_mapping\n  - source: /website/versioned_docs/**/*\n    translation: /website/i18n/%two_letters_code%/docusaurus-plugin-content-docs/**/%original_file_name%\n    languages_mapping: *languages_mapping\n  - source: /website/blog/**/*\n    translation: /website/i18n/%two_letters_code%/docusaurus-plugin-content-blog/**/%original_file_name%\n    languages_mapping: *languages_mapping\n  - source: /website/src/pages/**/*\n    translation: /website/i18n/%two_letters_code%/docusaurus-plugin-content-pages/**/%original_file_name%\n    ignore: [/**/*.js, /**/*.jsx, /**/*.ts, /**/*.tsx, /**/*.css]\n    languages_mapping: *languages_mapping\n#\n# Source files filter\n# e.g. "/resources/en/*.json"\n#\n#"source" : "/website/docs/**/*.md",\n#\n# Where translations will be placed\n# e.g. "/resources/docs/%two_letters_code%/%original_file_name%"\n#\n#"translation" : "/website/i18n/%language%/docs/current/%original_file_name%",\n#\n# Files or directories for ignore\n# e.g. ["/**/?.txt", "/**/[0-9].txt", "/**/*\\?*.txt"]\n#\n#"ignore" : [],\n#\n# The dest allows you to specify a file name in Crowdin\n# e.g. "/messages.json"\n#\n#"dest" : "",\n#\n# File type\n# e.g. "json"\n#\n#"type" : "",\n#\n# The parameter "update_option" is optional. If it is not set, after the files update the translations for changed strings will be removed. Use to fix typos and for minor changes in the source strings\n# e.g. "update_as_unapproved" or "update_without_changes"\n#\n#"update_option" : "",\n#\n# Start block (for XML only)\n#\n#\n# Defines whether to translate tags attributes.\n# e.g. 0 or 1  (Default is 1)\n#\n# "translate_attributes" : 1,\n#\n# Defines whether to translate texts placed inside the tags.\n# e.g. 0 or 1 (Default is 1)\n#\n# "translate_content" : 1,\n#\n# This is an array of strings, where each item is the XPaths to DOM element that should be imported\n# e.g. ["/content/text", "/content/text[@value]"]\n#\n# "translatable_elements" : [],\n#\n# Defines whether to split long texts into smaller text segments\n# e.g. 0 or 1 (Default is 1)\n#\n# "content_segmentation" : 1,\n#\n# End block (for XML only)\n#\n#\n# Start .properties block\n#\n#\n# Defines whether single quote should be escaped by another single quote or backslash in exported translations\n# e.g. 0 or 1 or 2 or 3 (Default is 3)\n# 0 - do not escape single quote;\n# 1 - escape single quote by another single quote;\n# 2 - escape single quote by backslash;\n# 3 - escape single quote by another single quote only in strings containing variables ( {0} ).\n#\n# "escape_quotes" : 3,\n#\n# Defines whether any special characters (=, :, ! and #) should be escaped by backslash in exported translations.\n# e.g. 0 or 1 (Default is 0)\n# 0 - do not escape special characters\n# 1 - escape special characters by a backslash\n#\n# "escape_special_characters": 0\n#\n#\n# End .properties block\n#\n#\n# Often software projects have custom names for the directories where translations are placed. crowdin-cli allows you to map your own languages to be understandable by Crowdin.\n#\n#"languages_mapping" : {\n#  "two_letters_code" : {\n#    "crowdin_language_code" : "local_name"\n#   }\n#},\n#\n# Does the first line contain header?\n# e.g. true or false\n#\n#"first_line_contains_header" : true,\n#\n# for spreadsheets\n# e.g. "identifier,source_phrase,context,uk,ru,fr"\n#\n# "scheme" : "",\n';var r=t(14526);const s={id:"crowdin",slug:"/i18n/crowdin",toc_max_heading_level:4},l="i18n - \u4f7f\u7528 Crowdin",p={unversionedId:"i18n/crowdin",id:"i18n/crowdin",title:"i18n - \u4f7f\u7528 Crowdin",description:"Docusaurus \u7684 i18n \u7cfb\u7edf\u662f\u4e0e\u4efb\u4f55\u7ffb\u8bd1\u8f6f\u4ef6\u89e3\u8026\u7684\u3002",source:"@site/docs/i18n/i18n-crowdin.mdx",sourceDirName:"i18n",slug:"/i18n/crowdin",permalink:"/docs/i18n/crowdin",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/i18n/i18n-crowdin.mdx",tags:[],version:"current",frontMatter:{id:"crowdin",slug:"/i18n/crowdin",toc_max_heading_level:4},sidebar:"docs",previous:{title:"i18n - \u4f7f\u7528 git",permalink:"/docs/i18n/git"},next:{title:"\u63a5\u4e0b\u6765\u662f\u4ec0\u4e48?",permalink:"/docs/guides/whats-next"}},d={},u=[{value:"Crowdin \u6982\u8ff0",id:"crowdin-overview",level:2},{value:"Crowdin \u6559\u7a0b",id:"crowdin-tutorial",level:2},{value:"\u51c6\u5907\u597d Docusaurus \u7684\u9057\u5740",id:"prepare-the-docusaurus-site",level:3},{value:"\u521b\u5efa\u4e00\u4e2a Crowdin \u9879\u76ee",id:"create-a-crowdin-project",level:3},{value:"\u521b\u5efa Crowdin \u914d\u7f6e",id:"create-the-crowdin-configuration",level:3},{value:"\u8bbf\u95ee\u4ee4\u724c",id:"access-token",level:4},{value:"\u5176\u4ed6\u914d\u7f6e\u5b57\u6bb5",id:"other-configuration-fields",level:4},{value:"\u5b89\u88c5 Crowdin \u547d\u4ee4\u884c",id:"install-the-crowdin-cli",level:3},{value:"\u4e0a\u4f20\u6e90\u7801",id:"upload-the-sources",level:3},{value:"\u7ffb\u8bd1\u8d44\u6599",id:"translate-the-sources",level:3},{value:"\u4e0b\u8f7d\u7ffb\u8bd1",id:"download-the-translations",level:3},{value:"\u4f7f\u7528 CI \u5b9e\u73b0\u81ea\u52a8\u5316",id:"automate-with-ci",level:3},{value:"\u9ad8\u7ea7\u62e5\u6324\u8bdd\u9898",id:"advanced-crowdin-topics",level:2},{value:"MDX",id:"mdx",level:3},{value:"MDX \u95ee\u9898",id:"mdx-problems",level:4},{value:"MDX \u89e3\u51b3\u65b9\u6848",id:"mdx-solutions",level:4},{value:"\u6587\u6863\u7248\u672c\u7ba1\u7406",id:"docs-versioning",level:3},{value:"\u591a\u5b9e\u4f8b\u7684\u63d2\u4ef6",id:"multi-instance-plugins",level:3},{value:"\u7ef4\u62a4\u60a8\u7684\u7f51\u7ad9",id:"maintaining-your-site",level:3},{value:"VCS (Git) \u96c6\u6210",id:"vcs-git-integrations",level:3},{value:"\u8bed\u5883\u5b9a\u4f4d",id:"in-context-localization",level:3},{value:"\u672c\u5730\u5316\u7f16\u8f91 URLs",id:"localize-edit-urls",level:3},{value:"\u793a\u4f8b\u914d\u7f6e",id:"example-configuration",level:3}],c={toc:u},m="wrapper";function g(e){let{components:n,...s}=e;return(0,i.kt)(m,(0,a.Z)({},c,s,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"i18n---\u4f7f\u7528-crowdin"},"i18n - \u4f7f\u7528 Crowdin"),(0,i.kt)("p",null,"Docusaurus \u7684 i18n \u7cfb\u7edf\u662f\u4e0e\u4efb\u4f55\u7ffb\u8bd1\u8f6f\u4ef6\u89e3\u8026\u7684\u3002"),(0,i.kt)("p",null,"\u60a8\u53ef\u4ee5\u5c06 Docusaurus \u4e0e\u60a8\u9009\u62e9\u7684\u5de5\u5177\u548c SaaS \u96c6\u6210\u5728\u4e00\u8d77\uff0c\u53ea\u8981\u5c06\u7ffb\u8bd1\u6587\u4ef6\u653e\u5728\u6b63\u786e\u7684\u4f4d\u7f6e\u5373\u53ef\u3002"),(0,i.kt)("p",null,"\u6211\u4eec\u8bb0\u5f55\u4e86",(0,i.kt)("a",{parentName:"p",href:"https://crowdin.com/"},"Crowdin"),"\u7684\u7528\u6cd5\uff0c\u4f5c\u4e3a\u4e00\u4e2a",(0,i.kt)("strong",{parentName:"p"},"\u53ef\u80fd\u7684"),"\u96c6\u6210\u793a\u4f8b\u3002"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"\u8fd9\u5e76\u4e0d\u662f\u5bf9 Crowdin \u4f5c\u4e3a\u7ffb\u8bd1 Docusaurus \u7f51\u7ad9\u7684\u552f\u4e00\u9009\u62e9\u7684\u8ba4\u53ef\uff0c\u4f46\u5b83\u88ab Facebook \u6210\u529f\u5730\u7528\u4e8e\u7ffb\u8bd1\u6587\u6863\u9879\u76ee\uff0c\u5982",(0,i.kt)("a",{parentName:"p",href:"https://jestjs.io/"},"Jest"),"\uff0c ",(0,i.kt)("a",{parentName:"p",href:"https://docusaurus.io/"},"Docusaurus"),"\u548c",(0,i.kt)("a",{parentName:"p",href:"https://reasonml.github.io/"},"ReasonML"),"\u3002"),(0,i.kt)("p",{parentName:"admonition"},"\u8bf7\u53c2\u8003 ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://support.crowdin.com/"},"Crowdin \u6587\u6863"))," \u548c ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"mailto:support@crowdin.com"},"Crowdin \u652f\u6301"))," \u83b7\u53d6\u5e2e\u52a9\u3002")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"\u4f7f\u7528\u8fd9\u4e2a ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/facebook/docusaurus/discussions/4052"},"\u793e\u533a\u9a71\u52a8\u7684 GitHub \u8ba8\u8bba"))," \u6765\u8ba8\u8bba\u4efb\u4f55\u4e0e Docusaurus + Crowdin \u76f8\u5173\u7684\u5185\u5bb9\u3002")),(0,i.kt)("h2",{id:"crowdin-overview"},"Crowdin \u6982\u8ff0"),(0,i.kt)("p",null,"Crowdin \u662f\u4e00\u4e2a\u7ffb\u8bd1\u8f6f\u4ef6\u5373\u670d\u52a1(SaaS)\uff0c\u63d0\u4f9b",(0,i.kt)("a",{parentName:"p",href:"https://crowdin.com/page/open-source-project-setup-request"},"\u5f00\u6e90\u9879\u76ee\u7684\u514d\u8d39\u8ba1\u5212"),"\u3002"),(0,i.kt)("p",null,"\u6211\u4eec\u63a8\u8350\u4ee5\u4e0b\u7ffb\u8bd1\u6d41\u7a0b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Upload sources")," to Crowdin (untranslated files)"),(0,i.kt)("li",{parentName:"ul"},"Use Crowdin to ",(0,i.kt)("strong",{parentName:"li"},"translate the content")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Download translations")," from Crowdin (localized translation files)")),(0,i.kt)("p",null,"Crowdin provides a ",(0,i.kt)("a",{parentName:"p",href:"https://support.crowdin.com/cli-tool/"},"CLI")," to ",(0,i.kt)("strong",{parentName:"p"},"upload sources")," and ",(0,i.kt)("strong",{parentName:"p"},"download translations"),", allowing you to automate the translation process."),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"https://support.crowdin.com/configuration-file/"},(0,i.kt)("inlineCode",{parentName:"a"},"crowdin.yml")," configuration file")," is convenient for Docusaurus, and permits to ",(0,i.kt)("strong",{parentName:"p"},"download the localized translation files at the expected location")," (in ",(0,i.kt)("inlineCode",{parentName:"p"},"i18n/[locale]/.."),")."),(0,i.kt)("p",null,"Read the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://support.crowdin.com/"},"official documentation"))," to know more about advanced features and different translation workflows."),(0,i.kt)("h2",{id:"crowdin-tutorial"},"Crowdin \u6559\u7a0b"),(0,i.kt)("p",null,"This is a walk-through of using Crowdin to translate a newly initialized English Docusaurus website into French, and assume you already followed the ",(0,i.kt)("a",{parentName:"p",href:"/docs/i18n/tutorial"},"i18n tutorial"),"."),(0,i.kt)("p",null,"The end result can be seen at ",(0,i.kt)("a",{parentName:"p",href:"https://docusaurus-crowdin-example.netlify.app/"},"docusaurus-crowdin-example.netlify.app")," (",(0,i.kt)("a",{parentName:"p",href:"https://github.com/slorber/docusaurus-crowdin-example"},"repository"),")."),(0,i.kt)("h3",{id:"prepare-the-docusaurus-site"},"\u51c6\u5907\u597d Docusaurus \u7684\u9057\u5740"),(0,i.kt)("p",null,"Initialize a new Docusaurus site:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npx create-docusaurus@latest website classic\n")),(0,i.kt)("p",null,"Add the site configuration for the French language:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="docusaurus.config.js"',title:'"docusaurus.config.js"'},'module.exports = {\n  i18n: {\n    defaultLocale: "en",\n    locales: ["en", "fr"],\n  },\n  themeConfig: {\n    navbar: {\n      items: [\n        // ...\n        {\n          type: "localeDropdown",\n          position: "left",\n        },\n        // ...\n      ],\n    },\n  },\n  // ...\n};\n')),(0,i.kt)("p",null,"Translate the homepage:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/index.js"',title:'"src/pages/index.js"'},'import React from "react";\nimport Translate from "@docusaurus/Translate";\nimport Layout from "@theme/Layout";\n\nexport default function Home() {\n  return (\n    <Layout>\n      <h1 style={{ margin: 20 }}>\n        <Translate description="The homepage main heading">Welcome to my Docusaurus translated site!</Translate>\n      </h1>\n    </Layout>\n  );\n}\n')),(0,i.kt)("h3",{id:"create-a-crowdin-project"},"\u521b\u5efa\u4e00\u4e2a Crowdin \u9879\u76ee"),(0,i.kt)("p",null,"Sign up on ",(0,i.kt)("a",{parentName:"p",href:"https://crowdin.com/"},"Crowdin"),", and create a project."),(0,i.kt)("p",null,"Use English as the source language, and French as the target language."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Create a Crowdin project with english as source language, and french as target language",src:t(96456).Z,width:"1868",height:"1576"})),(0,i.kt)("p",null,"Your project is created, but it is empty for now. We will upload the files to translate in the next steps."),(0,i.kt)("h3",{id:"create-the-crowdin-configuration"},"\u521b\u5efa Crowdin \u914d\u7f6e"),(0,i.kt)("p",null,"This configuration (",(0,i.kt)("a",{parentName:"p",href:"https://support.crowdin.com/configuration-file/"},"doc"),") provides a mapping for the Crowdin CLI to understand:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Where to find the source files to upload (JSON and Markdown)"),(0,i.kt)("li",{parentName:"ul"},"Where to download the files after translation (in ",(0,i.kt)("inlineCode",{parentName:"li"},"i18n/[locale]"),")")),(0,i.kt)("p",null,"Create ",(0,i.kt)("inlineCode",{parentName:"p"},"crowdin.yml")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"website"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml",metastring:'title="crowdin.yml"',title:'"crowdin.yml"'},'project_id: "123456"\napi_token_env: CROWDIN_PERSONAL_TOKEN\npreserve_hierarchy: true\nfiles:\n  # JSON translation files\n  - source: /i18n/en/**/*\n    translation: /i18n/%two_letters_code%/**/%original_file_name%\n  # Docs Markdown files\n  - source: /docs/**/*\n    translation: /i18n/%two_letters_code%/docusaurus-plugin-content-docs/current/**/%original_file_name%\n  # Blog Markdown files\n  - source: /blog/**/*\n    translation: /i18n/%two_letters_code%/docusaurus-plugin-content-blog/**/%original_file_name%\n')),(0,i.kt)("p",null,"Crowdin has its own syntax for declaring source/translation paths:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"**/*"),": everything in a subfolder"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"%two_letters_code%"),": the 2-letters variant of Crowdin target languages (",(0,i.kt)("inlineCode",{parentName:"li"},"fr")," in our case)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"**/%original_file_name%"),": the translations will preserve the original folder/file hierarchy")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The Crowdin CLI warnings are not always easy to understand."),(0,i.kt)("p",{parentName:"admonition"},"We advise to:"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"change one thing at a time"),(0,i.kt)("li",{parentName:"ul"},"re-upload sources after any configuration change"),(0,i.kt)("li",{parentName:"ul"},"use paths starting with ",(0,i.kt)("inlineCode",{parentName:"li"},"/")," (",(0,i.kt)("inlineCode",{parentName:"li"},"./")," does not work)"),(0,i.kt)("li",{parentName:"ul"},"avoid fancy globbing patterns like ",(0,i.kt)("inlineCode",{parentName:"li"},"/docs/**/*.(md|mdx)")," (does not work)"))),(0,i.kt)("h4",{id:"access-token"},"\u8bbf\u95ee\u4ee4\u724c"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"api_token_env")," attribute defines the ",(0,i.kt)("strong",{parentName:"p"},"env variable name")," read by the Crowdin CLI."),(0,i.kt)("p",null,"You can obtain a ",(0,i.kt)("inlineCode",{parentName:"p"},"Personal Access Token")," on ",(0,i.kt)("a",{parentName:"p",href:"https://crowdin.com/settings#api-key"},"your personal profile page"),"."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"You can keep the default value ",(0,i.kt)("inlineCode",{parentName:"p"},"CROWDIN_PERSONAL_TOKEN"),", and set this environment variable and on your computer and on the CI server to the generated access token.")),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"A Personal Access Tokens grant ",(0,i.kt)("strong",{parentName:"p"},"read-write access to all your Crowdin projects"),"."),(0,i.kt)("p",{parentName:"admonition"},"You should ",(0,i.kt)("strong",{parentName:"p"},"not commit")," it, and it may be a good idea to create a dedicated ",(0,i.kt)("strong",{parentName:"p"},"Crowdin profile for your company")," instead of using a personal account.")),(0,i.kt)("h4",{id:"other-configuration-fields"},"\u5176\u4ed6\u914d\u7f6e\u5b57\u6bb5"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"project_id"),": can be hardcoded, and is found on ",(0,i.kt)("inlineCode",{parentName:"li"},"https://crowdin.com/project/<MY_PROJECT_NAME>/settings#api")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"preserve_hierarchy"),": preserve the folder's hierarchy of your docs on Crowdin UI instead of flattening everything")),(0,i.kt)("h3",{id:"install-the-crowdin-cli"},"\u5b89\u88c5 Crowdin \u547d\u4ee4\u884c"),(0,i.kt)("p",null,"This tutorial uses the CLI version ",(0,i.kt)("inlineCode",{parentName:"p"},"3.5.2"),", but we expect ",(0,i.kt)("inlineCode",{parentName:"p"},"3.x")," releases to keep working."),(0,i.kt)("p",null,"Install the Crowdin CLI as an npm package to your Docusaurus site:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm install @crowdin/cli@3\n")),(0,i.kt)("p",null,"Add a ",(0,i.kt)("inlineCode",{parentName:"p"},"crowdin")," script:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="package.json"',title:'"package.json"'},'{\n  "scripts": {\n    // ...\n    "write-translations": "docusaurus write-translations",\n    "crowdin": "crowdin"\n  }\n}\n')),(0,i.kt)("p",null,"Test that you can run the Crowdin CLI:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm run crowdin -- --version\n")),(0,i.kt)("p",null,"Set the ",(0,i.kt)("inlineCode",{parentName:"p"},"CROWDIN_PERSONAL_TOKEN")," env variable on your computer, to allow the CLI to authenticate with the Crowdin API."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Temporarily, you can hardcode your personal token in ",(0,i.kt)("inlineCode",{parentName:"p"},"crowdin.yml")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"api_token: 'MY-TOKEN'"),".")),(0,i.kt)("h3",{id:"upload-the-sources"},"\u4e0a\u4f20\u6e90\u7801"),(0,i.kt)("p",null,"Generate the JSON translation files for the default language in ",(0,i.kt)("inlineCode",{parentName:"p"},"website/i18n/en"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm run write-translations\n")),(0,i.kt)("p",null,"Upload all the JSON and Markdown translation files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm run crowdin upload\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin CLI uploading Docusaurus source files",src:t(22335).Z,width:"1156",height:"682"})),(0,i.kt)("p",null,"Your source files are now visible on the Crowdin interface: ",(0,i.kt)("inlineCode",{parentName:"p"},"https://crowdin.com/project/<MY_PROJECT_NAME>/settings#files")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin UI showing Docusaurus source files",src:t(17295).Z,width:"2462",height:"1048"})),(0,i.kt)("h3",{id:"translate-the-sources"},"\u7ffb\u8bd1\u8d44\u6599"),(0,i.kt)("p",null,"On ",(0,i.kt)("inlineCode",{parentName:"p"},"https://crowdin.com/project/<MY_PROJECT_NAME>"),", click on the French target language."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin UI showing French translation files",src:t(86070).Z,width:"2430",height:"1736"})),(0,i.kt)("p",null,"Translate some Markdown files."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin UI to translate a Markdown file",src:t(99389).Z,width:"3044",height:"1586"})),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"Hide String")," to make sure translators ",(0,i.kt)("strong",{parentName:"p"},"don't translate things that should not be"),":"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Front matter: ",(0,i.kt)("inlineCode",{parentName:"li"},"id"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"slug"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"tags")," ..."),(0,i.kt)("li",{parentName:"ul"},"Admonitions: ",(0,i.kt)("inlineCode",{parentName:"li"},":::"),", ",(0,i.kt)("inlineCode",{parentName:"li"},":::note"),", ",(0,i.kt)("inlineCode",{parentName:"li"},":::tip")," ...")),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("img",{alt:"Crowdin UI hide string",src:t(96051).Z,width:"1518",height:"698"}))),(0,i.kt)("p",null,"Translate some JSON files."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin UI to translate a JSON file",src:t(9322).Z,width:"2868",height:"1490"})),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"description")," attribute of JSON translation files is visible on Crowdin to help translate the strings.")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://support.crowdin.com/pre-translation-via-machine/"},"Pre-translate"))," your site, and ",(0,i.kt)("strong",{parentName:"p"},"fix pre-translation mistakes manually")," (enable the Global Translation Memory in settings first)."),(0,i.kt)("p",{parentName:"admonition"},"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"Hide String")," feature first, as Crowdin is pre-translating things too optimistically.")),(0,i.kt)("h3",{id:"download-the-translations"},"\u4e0b\u8f7d\u7ffb\u8bd1"),(0,i.kt)("p",null,"Use the Crowdin CLI to download the translated JSON and Markdown files."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm run crowdin download\n")),(0,i.kt)("p",null,"The translated content should be downloaded in ",(0,i.kt)("inlineCode",{parentName:"p"},"i18n/fr"),"."),(0,i.kt)("p",null,"Start your site on the French locale:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:"npm2yarn",npm2yarn:!0},"npm run start -- --locale fr\n")),(0,i.kt)("p",null,"Make sure that your website is now translated in French at ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:3000/fr/"},(0,i.kt)("inlineCode",{parentName:"a"},"http://localhost:3000/fr/")),"."),(0,i.kt)("h3",{id:"automate-with-ci"},"\u4f7f\u7528 CI \u5b9e\u73b0\u81ea\u52a8\u5316"),(0,i.kt)("p",null,"We will configure the CI to ",(0,i.kt)("strong",{parentName:"p"},"download the Crowdin translations at build time")," and keep them outside of Git."),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"website/i18n")," to ",(0,i.kt)("inlineCode",{parentName:"p"},".gitignore"),"."),(0,i.kt)("p",null,"Set the ",(0,i.kt)("inlineCode",{parentName:"p"},"CROWDIN_PERSONAL_TOKEN")," env variable on your CI."),(0,i.kt)("p",null,"Create an npm script to ",(0,i.kt)("inlineCode",{parentName:"p"},"sync")," Crowdin (extract sources, upload sources, download translations):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="package.json"',title:'"package.json"'},'{\n  "scripts": {\n    "crowdin:sync": "docusaurus write-translations && crowdin upload && crowdin download"\n  }\n}\n')),(0,i.kt)("p",null,"Call the ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run crowdin:sync")," script in your CI, just before building the Docusaurus site."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Keep your deploy-previews fast: don't download translations, and use ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run build -- --locale en")," for feature branches.")),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Crowdin does not support well multiple concurrent uploads/downloads: it is preferable to only include translations to your production deployment, and keep deploy previews untranslated.")),(0,i.kt)("h2",{id:"advanced-crowdin-topics"},"\u9ad8\u7ea7\u62e5\u6324\u8bdd\u9898"),(0,i.kt)("h3",{id:"mdx"},"MDX"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Pay special attention to the JSX fragments in MDX documents!")),(0,i.kt)("p",null,"Crowdin ",(0,i.kt)("strong",{parentName:"p"},"does not support officially MDX"),", but they added ",(0,i.kt)("strong",{parentName:"p"},"support for the ",(0,i.kt)("inlineCode",{parentName:"strong"},".mdx")," extension"),", and interpret such files as Markdown (instead of plain text)."),(0,i.kt)("h4",{id:"mdx-problems"},"MDX \u95ee\u9898"),(0,i.kt)("p",null,"Crowdin thinks that the JSX syntax is embedded HTML and can mess up with the JSX markup when you download the translations, leading to a site that fails to build due to invalid JSX."),(0,i.kt)("p",null,"Simple JSX fragments using simple string props like ",(0,i.kt)("inlineCode",{parentName:"p"},'<Username name="Sebastien"/>')," will work fine; more complex JSX fragments using object/array props like ",(0,i.kt)("inlineCode",{parentName:"p"},'<User person={{name: "Sebastien"}}/>')," are more likely to fail due to a syntax that does not look like HTML."),(0,i.kt)("h4",{id:"mdx-solutions"},"MDX \u89e3\u51b3\u65b9\u6848"),(0,i.kt)("p",null,"\u6211\u4eec\u5efa\u8bae\u5c06\u590d\u6742\u7684\u5d4c\u5165\u5f0f JSX \u4ee3\u7801\u63d0\u53d6\u4e3a\u5355\u72ec\u7684\u72ec\u7acb\u7ec4\u4ef6\u3002\u6211\u4eec\u8fd8\u6dfb\u52a0\u4e86\u4e00\u4e2a",(0,i.kt)("inlineCode",{parentName:"p"},"mdx-code-block"),"\u7684\u9003\u751f\u8231\u53e3\u8bed\u6cd5:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'# How to deploy Docusaurus\n\nTo deploy Docusaurus, run the following command:\n\n````mdx-code-block\xa0\n\nimport Tabs from \'@theme/Tabs\';\n\nimport TabItem from \'@theme/TabItem\';\n\n<Tabs>\n  <TabItem value="bash" label="Bash">\n\n  ```bash\n  GIT_USER=<GITHUB_USERNAME> yarn deploy\n  ```\n\n  </TabItem>\n  <TabItem value="windows" label="Windows">\n\n  ```batch\n  cmd /C "set "GIT_USER=<GITHUB_USERNAME>" && yarn deploy"\n  ```\n\n  </TabItem>\n</Tabs>\n````\n')),(0,i.kt)("p",null,"\u8fd9\u5c06:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u88ab Crowdin \u89e3\u91ca\u4e3a\u4ee3\u7801\u5757(\u800c\u4e0d\u662f\u4e0e\u4e0b\u8f7d\u65f6\u7684\u6807\u8bb0\u6df7\u6dc6)"),(0,i.kt)("li",{parentName:"ul"},"\u88ab Docusaurus \u89e3\u91ca\u4e3a\u5e38\u89c4\u7684 JSX(\u5c31\u597d\u50cf\u5b83\u6ca1\u6709\u88ab\u4efb\u4f55\u4ee3\u7801\u5757\u5305\u88c5\u4e00\u6837)"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u5e78\u7684\u662f\uff0c\u9009\u62e9\u9000\u51fa MDX \u5de5\u5177(IDE \u8bed\u6cd5\u9ad8\u4eae\uff0c\u66f4\u6f02\u4eae\u2026)")),(0,i.kt)("h3",{id:"docs-versioning"},"\u6587\u6863\u7248\u672c\u7ba1\u7406"),(0,i.kt)("p",null,"Configure translation files for the ",(0,i.kt)("inlineCode",{parentName:"p"},"website/versioned_docs")," folder."),(0,i.kt)("p",null,"When creating a new version, the source strings will generally be quite similar to the current version (",(0,i.kt)("inlineCode",{parentName:"p"},"website/docs"),"), and you don't want to translate the new version docs again and again."),(0,i.kt)("p",null,"Crowdin provides a ",(0,i.kt)("inlineCode",{parentName:"p"},"Duplicate Strings")," setting."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin Duplicate Strings option setting",src:t(41365).Z,width:"1422",height:"368"})),(0,i.kt)("p",null,"We recommend using ",(0,i.kt)("inlineCode",{parentName:"p"},"Hide"),", but the ideal setting depends on how much your versions are different."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Not using ",(0,i.kt)("inlineCode",{parentName:"p"},"Hide")," leads to a much larger amount of ",(0,i.kt)("inlineCode",{parentName:"p"},"source strings")," in quotas, and will affect the pricing.")),(0,i.kt)("h3",{id:"multi-instance-plugins"},"\u591a\u5b9e\u4f8b\u7684\u63d2\u4ef6"),(0,i.kt)("p",null,"You need to configure translation files for each plugin instance."),(0,i.kt)("p",null,"If you have a docs plugin instance with ",(0,i.kt)("inlineCode",{parentName:"p"},"id=ios"),", you will need to configure those source files as well"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"website/ios")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"website/ios_versioned_docs")," (if versioned)")),(0,i.kt)("h3",{id:"maintaining-your-site"},"\u7ef4\u62a4\u60a8\u7684\u7f51\u7ad9"),(0,i.kt)("p",null,"Sometimes, you will ",(0,i.kt)("strong",{parentName:"p"},"remove or rename a source file")," on Git, and Crowdin will display CLI warnings:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin CLI: download translation warning",src:t(97553).Z,width:"2268",height:"886"})),(0,i.kt)("p",null,"When your sources are refactored, you should use the Crowdin UI to ",(0,i.kt)("strong",{parentName:"p"},"update your Crowdin files manually"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Crowdin UI: renaming a file",src:t(5784).Z,width:"2472",height:"1186"})),(0,i.kt)("h3",{id:"vcs-git-integrations"},"VCS (Git) \u96c6\u6210"),(0,i.kt)("p",null,"Crowdin has multiple VCS integrations for ",(0,i.kt)("a",{parentName:"p",href:"https://support.crowdin.com/github-integration/"},"GitHub"),", GitLab, Bitbucket."),(0,i.kt)("admonition",{title:"TL;DR",type:"warning"},(0,i.kt)("p",{parentName:"admonition"},"We recommend avoiding them.")),(0,i.kt)("p",null,"It could have been helpful to be able to edit the translations in both Git and Crowdin, and have a ",(0,i.kt)("strong",{parentName:"p"},"bi-directional sync")," between the 2 systems."),(0,i.kt)("p",null,"In practice, ",(0,i.kt)("strong",{parentName:"p"},"it didn't work very reliably")," for a few reasons:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The Crowdin -> Git sync works fine (with a pull request)"),(0,i.kt)("li",{parentName:"ul"},"The Git -> Crowdin sync is manual (you have to press a button)"),(0,i.kt)("li",{parentName:"ul"},"The heuristics used by Crowdin to match existing Markdown translations to existing Markdown sources are not 100% reliable, and you have to verify the result on Crowdin UI after any sync from Git"),(0,i.kt)("li",{parentName:"ul"},"2 users concurrently editing on Git and Crowdin can lead to a translation loss"),(0,i.kt)("li",{parentName:"ul"},"It requires the ",(0,i.kt)("inlineCode",{parentName:"li"},"crowdin.yml")," file to be at the root of the repository")),(0,i.kt)("h3",{id:"in-context-localization"},"\u8bed\u5883\u5b9a\u4f4d"),(0,i.kt)("p",null,"Crowdin has an ",(0,i.kt)("a",{parentName:"p",href:"https://support.crowdin.com/in-context-localization/"},"In-Context localization")," feature."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Unfortunately, it does not work yet for technical reasons, but we have good hope it can be solved."),(0,i.kt)("p",{parentName:"admonition"},"Crowdin replaces Markdown strings with technical IDs such as ",(0,i.kt)("inlineCode",{parentName:"p"},"crowdin:id12345"),", but it does so too aggressively, including hidden strings, and messes up with front matter, admonitions, JSX...")),(0,i.kt)("h3",{id:"localize-edit-urls"},"\u672c\u5730\u5316\u7f16\u8f91 URLs"),(0,i.kt)("p",null,"When the user is browsing a page at ",(0,i.kt)("inlineCode",{parentName:"p"},"/fr/doc1"),", the edit button will link by default to the unlocalized doc at ",(0,i.kt)("inlineCode",{parentName:"p"},"website/docs/doc1.md"),"."),(0,i.kt)("p",null,"You may prefer the edit button to link to the Crowdin interface instead by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"editUrl")," function to customize the edit URLs on a per-locale basis."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="docusaurus.config.js"',title:'"docusaurus.config.js"'},'const DefaultLocale = "en";\n\nmodule.exports = {\n  presets: [\n    [\n      "@docusaurus/preset-classic",\n      {\n        docs: {\n          // highlight-start\n          editUrl: ({ locale, versionDocsDirPath, docPath }) => {\n            // Link to Crowdin for French docs\n            if (locale !== DefaultLocale) {\n              return `https://crowdin.com/project/docusaurus-v2/${locale}`;\n            }\n            // Link to GitHub for English docs\n            return `https://github.com/facebook/docusaurus/edit/main/website/${versionDocsDirPath}/${docPath}`;\n          },\n          // highlight-end\n        },\n        blog: {\n          // highlight-start\n          editUrl: ({ locale, blogDirPath, blogPath }) => {\n            if (locale !== DefaultLocale) {\n              return `https://crowdin.com/project/docusaurus-v2/${locale}`;\n            }\n            return `https://github.com/facebook/docusaurus/edit/main/website/${blogDirPath}/${blogPath}`;\n          },\n          // highlight-start\n        },\n      },\n    ],\n  ],\n};\n')),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"It is currently ",(0,i.kt)("strong",{parentName:"p"},"not possible to link to a specific file")," in Crowdin.")),(0,i.kt)("h3",{id:"example-configuration"},"\u793a\u4f8b\u914d\u7f6e"),(0,i.kt)("p",null,"The ",(0,i.kt)("strong",{parentName:"p"},"Docusaurus v2 configuration file")," is a good example of using versioning and multi-instance:"),(0,i.kt)(r.Z,{className:"language-yaml",title:"crowdin.yml",mdxType:"CodeBlock"},o.split("\n").map((e=>!e.startsWith("#")&&e)).filter(Boolean).join("\n")))}g.isMDXComponent=!0},96456:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-create-project-2fe25e5974adc027f7ac2c36f1717de1.png"},97553:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-download-translations-warning-cb747bdcfc38beabea491f63781b9b40.png"},5784:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-files-rename-5ff9bf66f6123800006cf38ead6b66ae.png"},86070:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-french-translations-4f252e7f63a781628378eeb3a9fefb39.png"},96051:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-hide-string-5e470a33a42e044379bf6860ff534b50.png"},41365:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-settings-duplicate-strings-6943e2e4cab8910625a0b6c285052726.png"},17295:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-source-files-0ba8c0433421141418462c3bf6de22ed.png"},9322:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-translate-json-39a6b98aa60a84eba22b2f5834cbb97d.png"},99389:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-translate-markdown-0651cd22b5f07f0e9b3031ffaebbc5b6.png"},22335:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/crowdin-upload-sources-cli-5758c2f4d4256ac05d21b637d1d517bb.png"}}]);