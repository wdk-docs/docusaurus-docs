"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[388],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||r;return n?a.createElement(h,i(i({ref:t},p),{},{components:n})):a.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},45687:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),o=n(86010);const r={browserWindow:"browserWindow_my1Q",browserWindowHeader:"browserWindowHeader_jXSR",row:"row_KZDM",buttons:"buttons_uHc7",right:"right_oyze",browserWindowAddressBar:"browserWindowAddressBar_Pd8y",dot:"dot_giz1",browserWindowMenuIcon:"browserWindowMenuIcon_Vhuh",bar:"bar_rrRL",browserWindowBody:"browserWindowBody_Idgs"};function i(e){let{children:t,minHeight:n,url:i="http://localhost:3000",style:s,bodyStyle:l}=e;return a.createElement("div",{className:r.browserWindow,style:{...s,minHeight:n}},a.createElement("div",{className:r.browserWindowHeader},a.createElement("div",{className:r.buttons},a.createElement("span",{className:r.dot,style:{background:"#f25f58"}}),a.createElement("span",{className:r.dot,style:{background:"#fbbe3c"}}),a.createElement("span",{className:r.dot,style:{background:"#58cb42"}})),a.createElement("div",{className:(0,o.Z)(r.browserWindowAddressBar,"text--truncate")},i),a.createElement("div",{className:r.browserWindowMenuIcon},a.createElement("div",null,a.createElement("span",{className:r.bar}),a.createElement("span",{className:r.bar}),a.createElement("span",{className:r.bar})))),a.createElement("div",{className:r.browserWindowBody,style:l},t))}},63243:(e,t,n)=>{n.r(t),n.d(t,{FilePath:()=>h,PageRoute:()=>g,URLPath:()=>m,assets:()=>d,contentTitle:()=>u,default:()=>f,frontMatter:()=>l,metadata:()=>p,toc:()=>c});var a=n(87462),o=(n(67294),n(3905)),r=(n(83699),n(89871)),i=n(16550),s=n(45687);const l={description:"Docusaurus\u7684\u8def\u7531\u7cfb\u7edf\u9075\u5faa\u5355\u9875\u5e94\u7528\u60ef\u4f8b:\u4e00\u6761\u8def\u7531\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u3002"},u="\u8def\u7531",p={unversionedId:"advanced/routing",id:"advanced/routing",title:"\u8def\u7531",description:"Docusaurus\u7684\u8def\u7531\u7cfb\u7edf\u9075\u5faa\u5355\u9875\u5e94\u7528\u60ef\u4f8b:\u4e00\u6761\u8def\u7531\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u3002",source:"@site/docs/advanced/routing.mdx",sourceDirName:"advanced",slug:"/advanced/routing",permalink:"/docs/advanced/routing",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/advanced/routing.mdx",tags:[],version:"current",frontMatter:{description:"Docusaurus\u7684\u8def\u7531\u7cfb\u7edf\u9075\u5faa\u5355\u9875\u5e94\u7528\u60ef\u4f8b:\u4e00\u6761\u8def\u7531\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u3002"},sidebar:"docs",previous:{title:"\u63d2\u4ef6",permalink:"/docs/advanced/plugins"},next:{title:"\u9759\u6001\u7ad9\u70b9\u751f\u6210",permalink:"/docs/advanced/ssg"}},d={},c=[{value:"\u5185\u5bb9\u63d2\u4ef6\u4e2d\u7684\u8def\u7531",id:"routing-in-content-plugins",level:2},{value:"\u9875\u9762\u8def\u7531",id:"pages-routing",level:3},{value:"\u535a\u5ba2\u8def\u7531",id:"blog-routing",level:3},{value:"\u6587\u6863\u8def\u7531",id:"docs-routing",level:3},{value:"\u6587\u4ef6\u8def\u5f84\u548c URL \u8def\u5f84",id:"file-paths-and-url-paths",level:3},{value:"\u8def\u7531\u53d8\u6210 HTML \u6587\u4ef6",id:"routes-become-html-files",level:2},{value:"\u751f\u6210\u548c\u8bbf\u95ee\u8def\u7531",id:"generating-and-accessing-routes",level:2},{value:"\u9003\u907f SPA \u91cd\u5b9a\u5411",id:"escaping-from-spa-redirects",level:2}],m=()=>(0,o.kt)("code",null,(0,i.TH)().pathname),h=()=>{const e=(0,r.Iw)("default").activeVersion.name;return(0,o.kt)("code",null,"current"===e?"./docs/":`./versioned_docs/version-${e}/`,"advanced/routing.md")};function g(){const e=(0,i.TH)();return(0,o.kt)("span",null,"We are currently on ",(0,o.kt)("code",null,e.pathname))}const k={toc:c,URLPath:m,FilePath:h,PageRoute:g},b="wrapper";function f(e){let{components:t,...n}=e;return(0,o.kt)(b,(0,a.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u8def\u7531"},"\u8def\u7531"),(0,o.kt)("p",null,"Docusaurus \u7684\u8def\u7531\u7cfb\u7edf\u9075\u5faa\u5355\u9875\u5e94\u7528\u60ef\u4f8b:\u4e00\u6761\u8def\u7531\uff0c\u4e00\u4e2a\u7ec4\u4ef6\u3002\n\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u9996\u5148\u8ba8\u8bba\u4e09\u4e2a\u5185\u5bb9\u63d2\u4ef6(\u6587\u6863\u3001\u535a\u5ba2\u548c\u9875\u9762)\u4e2d\u7684\u8def\u7531\uff0c\u7136\u540e\u8fdb\u4e00\u6b65\u8ba8\u8bba\u5e95\u5c42\u8def\u7531\u7cfb\u7edf\u3002"),(0,o.kt)("h2",{id:"routing-in-content-plugins"},"\u5185\u5bb9\u63d2\u4ef6\u4e2d\u7684\u8def\u7531"),(0,o.kt)("p",null,"\u6bcf\u4e2a\u5185\u5bb9\u63d2\u4ef6\u90fd\u63d0\u4f9b\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"routeBasePath"),"\u9009\u9879\u3002\u5b83\u5b9a\u4e49\u4e86\u63d2\u4ef6\u5c06\u8def\u7531\u9644\u52a0\u5230\u54ea\u91cc\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cdocs \u63d2\u4ef6\u628a\u5b83\u7684\u8def\u7531\u653e\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"/docs"),"\u4e0b;\u535a\u5ba2\u63d2\u4ef6",(0,o.kt)("inlineCode",{parentName:"p"},"/blog"),";\u548c\u9875\u9762\u63d2\u4ef6",(0,o.kt)("inlineCode",{parentName:"p"},"/"),"\u3002\u4f60\u53ef\u4ee5\u8fd9\u6837\u8003\u8651\u8def\u7531\u7ed3\u6784:"),(0,o.kt)("mermaid",{value:'graph LR;\n    A(["https://example.com/"])\n    B(["/base-url/"])\n    C(["/docs/"])\n    D(["/blog/"])\n    E(["/"])\n    F["\u6240\u6709\u6587\u6863\u8def\u7531"]\n    G["\u6240\u6709\u535a\u5ba2\u8def\u7531"]\n    H["\u6240\u6709\u9875\u9762\u8def\u7531"]\n    A---B;\n    B---C;\n    B---D;\n    B---E;\n    C---F;\n    D---G;\n    E---H;'}),(0,o.kt)("p",null,"\u4efb\u4f55\u8def\u7531\u90fd\u5c06\u4e0e\u8fd9\u4e2a\u5d4c\u5957\u7684\u8def\u7531\u914d\u7f6e\u5339\u914d\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u597d\u7684\u5339\u914d\u3002\u4f8b\u5982\uff0c\u5f53\u7ed9\u5b9a\u4e00\u4e2a\u8def\u7531",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/configuration"),"\u65f6\uff0cDocusaurus \u9996\u5148\u8fdb\u5165",(0,o.kt)("inlineCode",{parentName:"p"},"/docs"),"\u5206\u652f\uff0c\u7136\u540e\u5728 docs \u63d2\u4ef6\u521b\u5efa\u7684\u5b50\u8def\u7531\u4e2d\u641c\u7d22\u3002"),(0,o.kt)("p",null,"\u66f4\u6539",(0,o.kt)("inlineCode",{parentName:"p"},"routeBasePath"),"\u53ef\u4ee5\u6709\u6548\u5730\u6539\u53d8\u7ad9\u70b9\u7684\u8def\u7531\u7ed3\u6784\u3002\u4f8b\u5982\uff0c\u5728",(0,o.kt)("a",{parentName:"p",href:"/docs/docs-introduction#docs-only-mode"},"docs-only \u6a21\u5f0f"),"\u4e2d\uff0c\u6211\u4eec\u63d0\u5230\u4e3a docs \u914d\u7f6e",(0,o.kt)("inlineCode",{parentName:"p"},"routeBasePath: '/'"),"\u610f\u5473\u7740 docs \u63d2\u4ef6\u521b\u5efa\u7684\u6240\u6709\u8def\u7531\u90fd\u4e0d\u4f1a\u6709",(0,o.kt)("inlineCode",{parentName:"p"},"/docs"),"\u524d\u7f00\uff0c\u4f46\u5b83\u5e76\u4e0d\u80fd\u963b\u6b62\u5176\u4ed6\u63d2\u4ef6\u521b\u5efa\u66f4\u591a\u50cf",(0,o.kt)("inlineCode",{parentName:"p"},"/blog"),"\u8fd9\u6837\u7684\u5b50\u8def\u7531\u3002"),(0,o.kt)("p",null,"\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u770b\u770b\u8fd9\u4e09\u4e2a\u63d2\u4ef6\u662f\u5982\u4f55\u6784\u5efa\u5b83\u4eec\u81ea\u5df1\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"\u5b50\u8def\u7531\u76d2\u5b50"),"\u7684\u3002"),(0,o.kt)("h3",{id:"pages-routing"},"\u9875\u9762\u8def\u7531"),(0,o.kt)("p",null,"\u9875\u9762\u8def\u7531\u5f88\u7b80\u5355:\u6587\u4ef6\u8def\u5f84\u76f4\u63a5\u6620\u5c04\u5230 URLs\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u5176\u4ed6\u81ea\u5b9a\u4e49\u65b9\u5f0f\u3002\u8bf7\u53c2\u9605",(0,o.kt)("a",{parentName:"p",href:"/docs/creating-pages#routing"},"pages \u6587\u6863"),"\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002"),(0,o.kt)("p",null,"\u7528\u4e8e Markdown \u9875\u9762\u7684\u7ec4\u4ef6\u662f",(0,o.kt)("inlineCode",{parentName:"p"},"@theme/MDXPage"),"\u3002React \u9875\u9762\u88ab\u76f4\u63a5\u7528\u4f5c\u8def\u7531\u7684\u7ec4\u4ef6\u3002"),(0,o.kt)("h3",{id:"blog-routing"},"\u535a\u5ba2\u8def\u7531"),(0,o.kt)("p",null,"\u8be5\u535a\u5ba2\u521b\u5efa\u4e86\u4ee5\u4e0b\u8def\u7531:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Posts list pages"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"/"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"/page/2"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"/page/3"),"...",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"The component is ",(0,o.kt)("inlineCode",{parentName:"li"},"@theme/BlogListPage"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Post pages"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"/2021/11/21/algolia-docsearch-migration"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"/2021/05/12/announcing-docusaurus-two-beta"),"...",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Generated from each Markdown post."),(0,o.kt)("li",{parentName:"ul"},"The routes are fully customizable through the ",(0,o.kt)("inlineCode",{parentName:"li"},"slug")," front matter."),(0,o.kt)("li",{parentName:"ul"},"The component is ",(0,o.kt)("inlineCode",{parentName:"li"},"@theme/BlogPostPage"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Tags list page"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"/tags"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"The route is customizable through the ",(0,o.kt)("inlineCode",{parentName:"li"},"tagsBasePath")," option."),(0,o.kt)("li",{parentName:"ul"},"The component is ",(0,o.kt)("inlineCode",{parentName:"li"},"@theme/BlogTagsListPage"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Tag pages"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"/tags/adoption"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"/tags/beta"),"...",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Generated through the tags defined in each post's front matter."),(0,o.kt)("li",{parentName:"ul"},"The routes always have base defined in ",(0,o.kt)("inlineCode",{parentName:"li"},"tagsBasePath"),", but the subroutes are customizable through the tag's ",(0,o.kt)("inlineCode",{parentName:"li"},"permalink")," field."),(0,o.kt)("li",{parentName:"ul"},"The component is ",(0,o.kt)("inlineCode",{parentName:"li"},"@theme/BlogTagsPostsPage"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Archive page"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"/archive"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"The route is customizable through the ",(0,o.kt)("inlineCode",{parentName:"li"},"archiveBasePath")," option."),(0,o.kt)("li",{parentName:"ul"},"The component is ",(0,o.kt)("inlineCode",{parentName:"li"},"@theme/BlogArchivePage"),".")))),(0,o.kt)("h3",{id:"docs-routing"},"\u6587\u6863\u8def\u7531"),(0,o.kt)("p",null,"The docs is the only plugin that creates ",(0,o.kt)("strong",{parentName:"p"},"nested routes"),". At the top, it registers ",(0,o.kt)("a",{parentName:"p",href:"/docs/versioning"},(0,o.kt)("strong",{parentName:"a"},"version paths")),": ",(0,o.kt)("inlineCode",{parentName:"p"},"/"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"/next"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"/2.0.0-beta.13"),"... which provide the version context, including the layout and sidebar. This ensures that when switching between individual docs, the sidebar's state is preserved, and that you can switch between versions through the navbar dropdown while staying on the same doc. The component used is ",(0,o.kt)("inlineCode",{parentName:"p"},"@theme/DocPage"),"."),(0,o.kt)("p",null,"The individual docs are rendered in the remaining space after the navbar, footer, sidebar, etc. have all been provided by the ",(0,o.kt)("inlineCode",{parentName:"p"},"DocPage")," component. For example, this page, ",(0,o.kt)(m,{mdxType:"URLPath"}),", is generated from the file at ",(0,o.kt)(h,{mdxType:"FilePath"}),". The component used is ",(0,o.kt)("inlineCode",{parentName:"p"},"@theme/DocItem"),"."),(0,o.kt)("p",null,"The doc's ",(0,o.kt)("inlineCode",{parentName:"p"},"slug")," front matter customizes the last part of the route, but the base route is always defined by the plugin's ",(0,o.kt)("inlineCode",{parentName:"p"},"routeBasePath")," and the version's ",(0,o.kt)("inlineCode",{parentName:"p"},"path"),"."),(0,o.kt)("h3",{id:"file-paths-and-url-paths"},"\u6587\u4ef6\u8def\u5f84\u548c URL \u8def\u5f84"),(0,o.kt)("p",null,"Throughout the documentation, we always try to be unambiguous about whether we are talking about file paths or URL paths. Content plugins usually map file paths directly to URL paths, for example, ",(0,o.kt)("inlineCode",{parentName:"p"},"./docs/advanced/routing.md")," will become ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing"),". However, with ",(0,o.kt)("inlineCode",{parentName:"p"},"slug"),", you can make URLs totally decoupled from the file structure."),(0,o.kt)("p",null,"When writing links in Markdown, you could either mean a ",(0,o.kt)("em",{parentName:"p"},"file path"),", or a ",(0,o.kt)("em",{parentName:"p"},"URL path"),", which Docusaurus would use several heuristics to determine."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If the path has a ",(0,o.kt)("inlineCode",{parentName:"li"},"@site")," prefix, it is ",(0,o.kt)("em",{parentName:"li"},"always")," an asset file path."),(0,o.kt)("li",{parentName:"ul"},"If the path has an ",(0,o.kt)("inlineCode",{parentName:"li"},"http(s)://")," prefix, it is ",(0,o.kt)("em",{parentName:"li"},"always")," a URL path."),(0,o.kt)("li",{parentName:"ul"},"If the path doesn't have an extension, it is a URL path. For example, a link ",(0,o.kt)("inlineCode",{parentName:"li"},"[page](../plugins)")," on a page with URL ",(0,o.kt)("inlineCode",{parentName:"li"},"/docs/advanced/routing")," will link to ",(0,o.kt)("inlineCode",{parentName:"li"},"/docs/plugins"),". Docusaurus will only detect broken links when building your site (when it knows the full route structure), but will make no assumptions about the existence of a file. It is exactly equivalent to writing ",(0,o.kt)("inlineCode",{parentName:"li"},'<a href="../plugins">page</a>')," in a JSX file."),(0,o.kt)("li",{parentName:"ul"},"If the path has an ",(0,o.kt)("inlineCode",{parentName:"li"},".md(x)")," extension, Docusaurus would try to resolve that Markdown file to a URL, and replace the file path with a URL path."),(0,o.kt)("li",{parentName:"ul"},"If the path has any other extension, Docusaurus would treat it as ",(0,o.kt)("a",{parentName:"li",href:"/docs/markdown-features/assets"},"an asset")," and bundle it.")),(0,o.kt)("p",null,"The following directory structure may help you visualize this file \u2192 URL mapping. Assume that there's no slug customization in any page."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"A sample site structure"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 blog                            # blog plugin has routeBasePath: '/blog'\n\u2502   \u251c\u2500\u2500 2019-05-28-first-blog-post.md       # -> /blog/2019/05/28/first-blog-post\n\u2502   \u251c\u2500\u2500 2019-05-29-long-blog-post.md        # -> /blog/2019/05/29/long-blog-post\n\u2502   \u251c\u2500\u2500 2021-08-01-mdx-blog-post.mdx        # -> /blog/2021/08/01/mdx-blog-post\n\u2502   \u2514\u2500\u2500 2021-08-26-welcome\n\u2502       \u251c\u2500\u2500 docusaurus-plushie-banner.jpeg\n\u2502       \u2514\u2500\u2500 index.md                        # -> /blog/2021/08/26/welcome\n\u251c\u2500\u2500 docs                            # docs plugin has routeBasePath: '/docs'; current version has base path '/'\n\u2502   \u251c\u2500\u2500 intro.md                            # -> /docs/intro\n\u2502   \u251c\u2500\u2500 tutorial-basics\n\u2502   \u2502   \u251c\u2500\u2500 _category_.json\n\u2502   \u2502   \u251c\u2500\u2500 congratulations.md              # -> /docs/tutorial-basics/congratulations\n\u2502   \u2502   \u2514\u2500\u2500 markdown-features.mdx           # -> /docs/tutorial-basics/congratulations\n\u2502   \u2514\u2500\u2500 tutorial-extras\n\u2502       \u251c\u2500\u2500 _category_.json\n\u2502       \u251c\u2500\u2500 manage-docs-versions.md         # -> /docs/tutorial-extras/manage-docs-versions\n\u2502       \u2514\u2500\u2500 translate-your-site.md          # -> /docs/tutorial-extras/translate-your-site\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 pages                       # pages plugin has routeBasePath: '/'\n\u2502       \u251c\u2500\u2500 index.module.css\n\u2502       \u251c\u2500\u2500 index.tsx                       # -> /\n\u2502       \u2514\u2500\u2500 markdown-page.md                # -> /markdown-page\n\u2514\u2500\u2500 versioned_docs\n    \u2514\u2500\u2500 version-1.0.0               # version has base path '/1.0.0'\n        \u251c\u2500\u2500 intro.md                        # -> /docs/1.0.0/intro\n        \u251c\u2500\u2500 tutorial-basics\n        \u2502   \u251c\u2500\u2500 _category_.json\n        \u2502   \u251c\u2500\u2500 congratulations.md          # -> /docs/1.0.0/tutorial-basics/congratulations\n        \u2502   \u2514\u2500\u2500 markdown-features.mdx       # -> /docs/1.0.0/tutorial-basics/markdown-features\n        \u2514\u2500\u2500 tutorial-extras\n            \u251c\u2500\u2500 _category_.json\n            \u251c\u2500\u2500 manage-docs-versions.md     # -> /docs/1.0.0/tutorial-extras/manage-docs-versions\n            \u2514\u2500\u2500 translate-your-site.md      # -> /docs/1.0.0/tutorial-extras/translate-your-site\n"))),(0,o.kt)("p",null,"So much about content plugins. Let's take one step back and talk about how routing works in a Docusaurus app in general."),(0,o.kt)("h2",{id:"routes-become-html-files"},"\u8def\u7531\u53d8\u6210 HTML \u6587\u4ef6"),(0,o.kt)("p",null,"Because Docusaurus is a server-side rendering framework, all routes generated will be server-side rendered into static HTML files. If you are familiar with the behavior of HTTP servers like ",(0,o.kt)("a",{parentName:"p",href:"https://httpd.apache.org/docs/trunk/getting-started.html"},"Apache2"),", you will understand how this is done: when the browser sends a request to the route ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing"),", the server interprets that as request for the HTML file ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing/index.html"),", and returns that."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing")," route can correspond to either ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing/index.html")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"/docs/advanced/routing.html"),". Some hosting providers differentiate between them using the presence of a trailing slash, and may or may not tolerate the other. Read more in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/slorber/trailing-slash-guide"},"trailing slash guide"),"."),(0,o.kt)("p",null,"For example, the build output of the directory above is (ignoring other assets and JS bundle):"),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Output of the above workspace"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"build\n\u251c\u2500\u2500 404.html                      # /404/\n\u251c\u2500\u2500 blog\n\u2502   \u251c\u2500\u2500 archive\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /blog/archive/\n\u2502   \u251c\u2500\u2500 first-blog-post\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /blog/first-blog-post/\n\u2502   \u251c\u2500\u2500 index.html                # /blog/\n\u2502   \u251c\u2500\u2500 long-blog-post\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /blog/long-blog-post/\n\u2502   \u251c\u2500\u2500 mdx-blog-post\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /blog/mdx-blog-post/\n\u2502   \u251c\u2500\u2500 tags\n\u2502   \u2502   \u251c\u2500\u2500 docusaurus\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html        # /blog/tags/docusaurus/\n\u2502   \u2502   \u251c\u2500\u2500 hola\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html        # /blog/tags/hola/\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /blog/tags/\n\u2502   \u2514\u2500\u2500 welcome\n\u2502       \u2514\u2500\u2500 index.html            # /blog/welcome/\n\u251c\u2500\u2500 docs\n\u2502   \u251c\u2500\u2500 1.0.0\n\u2502   \u2502   \u251c\u2500\u2500 intro\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html        # /docs/1.0.0/intro/\n\u2502   \u2502   \u251c\u2500\u2500 tutorial-basics\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 congratulations\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html    # /docs/1.0.0/tutorial-basics/congratulations/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 markdown-features\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 index.html    # /docs/1.0.0/tutorial-basics/markdown-features/\n\u2502   \u2502   \u2514\u2500\u2500 tutorial-extras\n\u2502   \u2502       \u251c\u2500\u2500 manage-docs-versions\n\u2502   \u2502       \u2502   \u2514\u2500\u2500 index.html    # /docs/1.0.0/tutorial-extras/manage-docs-versions/\n\u2502   \u2502       \u2514\u2500\u2500 translate-your-site\n\u2502   \u2502           \u2514\u2500\u2500 index.html    # /docs/1.0.0/tutorial-extras/translate-your-site/\n\u2502   \u251c\u2500\u2500 intro\n\u2502   \u2502   \u2514\u2500\u2500 index.html            # /docs/1.0.0/intro/\n\u2502   \u251c\u2500\u2500 tutorial-basics\n\u2502   \u2502   \u251c\u2500\u2500 congratulations\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.html        # /docs/tutorial-basics/congratulations/\n\u2502   \u2502   \u2514\u2500\u2500 markdown-features\n\u2502   \u2502       \u2514\u2500\u2500 index.html        # /docs/tutorial-basics/markdown-features/\n\u2502   \u2514\u2500\u2500 tutorial-extras\n\u2502       \u251c\u2500\u2500 manage-docs-versions\n\u2502       \u2502   \u2514\u2500\u2500 index.html        # /docs/tutorial-extras/manage-docs-versions/\n\u2502       \u2514\u2500\u2500 translate-your-site\n\u2502           \u2514\u2500\u2500 index.html        # /docs/tutorial-extras/translate-your-site/\n\u251c\u2500\u2500 index.html                    # /\n\u2514\u2500\u2500 markdown-page\n    \u2514\u2500\u2500 index.html                # /markdown-page/\n"))),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"trailingSlash")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),", the build would emit ",(0,o.kt)("inlineCode",{parentName:"p"},"intro.html")," instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"intro/index.html"),"."),(0,o.kt)("p",null,"All HTML files will reference its JS assets using absolute URLs, so in order for the correct assets to be located, you have to configure the ",(0,o.kt)("inlineCode",{parentName:"p"},"baseUrl")," field. Note that ",(0,o.kt)("inlineCode",{parentName:"p"},"baseUrl")," doesn't affect the emitted bundle's file structure: the base URL is one level above the Docusaurus routing system. You can see the aggregate of ",(0,o.kt)("inlineCode",{parentName:"p"},"url")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"baseUrl")," as the actual location of your Docusaurus site."),(0,o.kt)("p",null,"For example, the emitted HTML would contain links like ",(0,o.kt)("inlineCode",{parentName:"p"},'<link rel="preload" href="/assets/js/runtime~main.7ed5108a.js" as="script">'),". Because absolute URLs are resolved from the host, if the bundle placed under the path ",(0,o.kt)("inlineCode",{parentName:"p"},"https://example.com/base/"),", the link will point to ",(0,o.kt)("inlineCode",{parentName:"p"},"https://example.com/assets/js/runtime~main.7ed5108a.js"),", which is, well, non-existent. By specifying ",(0,o.kt)("inlineCode",{parentName:"p"},"/base/")," as base URL, the link will correctly point to ",(0,o.kt)("inlineCode",{parentName:"p"},"/base/assets/js/runtime~main.7ed5108a.js"),"."),(0,o.kt)("p",null,"Localized sites have the locale as part of the base URL as well. For example, ",(0,o.kt)("inlineCode",{parentName:"p"},"https://docusaurus.io/zh-CN/docs/advanced/routing/")," has base URL ",(0,o.kt)("inlineCode",{parentName:"p"},"/zh-CN/"),"."),(0,o.kt)("h2",{id:"generating-and-accessing-routes"},"\u751f\u6210\u548c\u8bbf\u95ee\u8def\u7531"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"addRoute")," lifecycle action is used to generate routes. It registers a piece of route config to the route tree, giving a route, a component, and props that the component needs. The props and the component are both provided as paths for the bundler to ",(0,o.kt)("inlineCode",{parentName:"p"},"require"),", because as explained in the ",(0,o.kt)("a",{parentName:"p",href:"/docs/advanced/architecture"},"architecture overview"),", server and client only communicate through temp files."),(0,o.kt)("p",null,"All routes are aggregated in ",(0,o.kt)("inlineCode",{parentName:"p"},".docusaurus/routes.js"),", which you can view with the debug plugin's ",(0,o.kt)("a",{parentName:"p",href:"/__docusaurus/debug/routes"},"routes panel"),"."),(0,o.kt)("p",null,"On the client side, we offer ",(0,o.kt)("inlineCode",{parentName:"p"},"@docusaurus/router")," to access the page's route. ",(0,o.kt)("inlineCode",{parentName:"p"},"@docusaurus/router")," is a re-export of the ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/react-router-dom/v/5.3.0"},(0,o.kt)("inlineCode",{parentName:"a"},"react-router-dom"))," package. For example, you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"useLocation")," to get the current page's ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Location"},"location"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"useHistory")," to access the ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History"},"history object"),". (They are not the same as the browser API, although similar in functionality. Refer to the React Router documentation for specific APIs.)"),(0,o.kt)("p",null,"This API is ",(0,o.kt)("strong",{parentName:"p"},"SSR safe"),", as opposed to the browser-only ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="myComponent.js"',title:'"myComponent.js"'},'import React from "react";\nimport { useLocation } from "@docusaurus/router";\n\nexport function PageRoute() {\n  // React router provides the current component\'s route, even in SSR\n  const location = useLocation();\n  return (\n    <span>\n      We are currently on <code>{location.pathname}</code>\n    </span>\n  );\n}\n')),(0,o.kt)(s.Z,{mdxType:"BrowserWindow"},(0,o.kt)(g,{mdxType:"PageRoute"})),(0,o.kt)("h2",{id:"escaping-from-spa-redirects"},"\u9003\u907f SPA \u91cd\u5b9a\u5411"),(0,o.kt)("p",null,"Docusaurus builds a ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/SPA"},"single-page application"),", where route transitions are done through the ",(0,o.kt)("inlineCode",{parentName:"p"},"history.push()")," method of React router. This operation is done on the client side. However, the prerequisite for a route transition to happen this way is that the target URL is known to our router. Otherwise, the router catches this path and displays a 404 page instead."),(0,o.kt)("p",null,"If you put some HTML pages under the ",(0,o.kt)("inlineCode",{parentName:"p"},"static")," folder, they will be copied to the build output and therefore become accessible as part of your website, yet it's not part of the Docusaurus route system. We provide a ",(0,o.kt)("inlineCode",{parentName:"p"},"pathname://")," protocol that allows you to redirect to another part of your domain in a non-SPA fashion, as if this route is an external link. Try the following two links:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-md"},"- [/pure-html](/pure-html)\n- [pathname:///pure-html](pathname:///pure-html)\n")),(0,o.kt)(s.Z,{mdxType:"BrowserWindow"},(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/pure-html"},(0,o.kt)("inlineCode",{parentName:"a"},"/pure-html"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"pathname:///pure-html"},(0,o.kt)("inlineCode",{parentName:"a"},"pathname:///pure-html"))))),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The first link will ",(0,o.kt)("strong",{parentName:"p"},"not"),' trigger a "broken links detected" check during the production build, because the respective file actually exists. Nevertheless, when you click on the link, a "page not found" will be displayed until you refresh.')),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"pathname://")," protocol is useful for referencing any content in the static folder. For example, Docusaurus would convert ",(0,o.kt)("a",{parentName:"p",href:"/docs/markdown-features/assets#static-assets"},"all Markdown static assets to require() calls"),". You can use ",(0,o.kt)("inlineCode",{parentName:"p"},"pathname://")," to keep it a regular link instead of being hashed by Webpack."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-md",metastring:'title="my-doc.md"',title:'"my-doc.md"'},"![An image from the static](pathname:///img/docusaurus.png)\n\n[An asset from the static](pathname:///files/asset.pdf)\n")),(0,o.kt)("p",null,"Docusaurus will only strip the ",(0,o.kt)("inlineCode",{parentName:"p"},"pathname://")," prefix without processing the content."))}f.isMDXComponent=!0}}]);